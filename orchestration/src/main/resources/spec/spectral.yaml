extends: spectral:oas

rules:
  oneOfs-with-multi-array:
    description: "[Java SDK] Cannot handle oneOfs with multiple array options."
    given: $..oneOf
    severity: error
    then:
      function: length
      functionOptions:
        max: 1
      field: "[?(@.type=='array')]"

  oneOf-object-distinguishability:
    description: "[Java SDK] oneOf options in response schemas may not be distinguishable for deserialization. Add discriminator or ensure unique required properties exist."
    given:
      - $..responses[*]..oneOf
      - $.components.schemas[*]..oneOf
    severity: warn
    then:
      function: oneOfObjectDistinguishability

functions:
  - "oneOfObjectDistinguishability"
