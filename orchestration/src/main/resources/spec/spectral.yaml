extends: spectral:oas

rules:
  oneOfs-with-multi-array:
    description: The Java SDK cannot handle oneOfs with multiple array options.
    given: $..oneOf
    severity: error
    then:
      function: length
      functionOptions:
        max: 1
      field: "[?(@.type=='array')]"

  oneOf-object-distinguishability:
    description: oneOf schemas in API responses must be distinguishable for Java SDK deserialization
    given:
      - $.paths[*][*].responses[*]..oneOf
      - $.components.schemas[*]..oneOf
    severity: warn
    then:
      function: oneOfObjectDistinguishability

functions:
  - "oneOfObjectDistinguishability"
